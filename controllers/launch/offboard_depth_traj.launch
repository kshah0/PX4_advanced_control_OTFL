<launch>
    <arg name="mav_name" default="iris"/>
    <arg name="command_input" default="2" />
    <arg name="gazebo_simulation" default="true" />

	<include file="$(find structure_core_ros_driver)/launch/sc.launch">
		<arg name="name"                  value="camera_main"/>
		<arg name="required"              value="true"/>
		<arg name="serial_number"         value="null"/>
		<arg name="infrared_enable"       value="false" />
		<arg name="visible_enable"       value="false" />
		<arg name="depth_enable"          value="true" />
		<arg name="depth_pcloud_enable"   value="false" />
		<arg name="frame_sync_enabled"    value="false" />
		<arg name="depth_framerate"       value="15.0" />
		<arg name="depth_resolution"      value="_320x240" />
                <arg name="latency_reducer_enabled" value="true" />
		<arg name="depth_apply_correction_before_stream"              value="true"/>
    </include>

	<node pkg="geometric_controller" type="geometric_controller_node" name="geometric_controller" output="screen">
		<param name="mav_name" type="string" value="$(arg mav_name)" />
		<remap from="command/bodyrate_command" to="/mavros/setpoint_raw/attitude"/>
		<param name="ctrl_mode" value="$(arg command_input)" />
		<param name="enable_sim" value="$(arg gazebo_simulation)" />
		<param name="enable_gazebo_state" value="true"/>
		<param name="max_acc" value="10.0" />
		<!-- CHANGE THIS PARAMETER TO SET THE INITIAL POSITION OF THE DRONE -->
		<param name="init_pos_x" value="0" />
		<param name="init_pos_y" value="0" />
		<param name="init_pos_z" value="0" />
		<param name="Kp_x" value="8.0" />
		<param name="Kp_y" value="8.0" />
		<param name="Kp_z" value="10.0" />
		<param name="normalizedthrust_constant" value="0.037" />
		<param name="normalizedthrust_offset" value="0" />
    </node>

	<!-- run batch file -->
  	<node name="offboard_setup" pkg="controllers" type="offboard_setup.sh" output="screen"/>

	<!-- set or toggle rqt parameters -->
    <node name="rqt_param_toggle" pkg="local_planner" type="rqt_param_toggle.sh" />
	
</launch>
